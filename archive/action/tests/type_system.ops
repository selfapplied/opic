;;; test_type_system.ops â€” Test def types and type system

include core/bootstrap.ops

;; Test definitions
def test_type { name, value, expected }

;; Test 1: Type definition
voice test.type.definition / {
  "test_type" -> 
  "Type definition: PASS"
}

;; Test 2: Type field access
voice test.type.field_access / {
  test_type.name -> 
  test_type.value -> 
  test_type.expected -> 
  "Field access: PASS"
}

;; Test 3: Type instantiation
voice test.type.instantiation / {
  "name" + "value" + "expected" -> 
  create_test_type -> 
  "Instantiation: PASS"
}

voice create_test_type / {
  name + value + expected -> 
  test_type
}

;; Test 4: Type composition
voice test.type.composition / {
  type_a -> 
  type_b -> 
  compose_types -> 
  "Composition: PASS"
}

voice type_a / {"a"}
voice type_b / {"b"}
voice compose_types / {type_a + type_b -> "composed"}

;; Main test runner
voice test.type.all / {
  test.type.definition -> 
  test.type.field_access -> 
  test.type.instantiation -> 
  test.type.composition -> 
  "Type system tests: PASS"
}

target test_type_system / "type_system_tests"
voice main / {test.type.all -> test_type_system}

