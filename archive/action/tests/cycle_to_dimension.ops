;;; test_cycle_to_dimension.ops — Tests for Cycle-to-Dimension Principle

;; Test structure (following opic's test pattern)
def test { name, input, expected, actual, passed }

;; ============================================================================
;; Test 1: Cycle Phase Computation
;; ============================================================================

voice test.cycle.phase / "Test cycle phase computation"
voice test.cycle.phase.input / "cycle_with_voices"
voice test.cycle.phase.expected / "theta_C_computed"
voice test.cycle.phase.actual / {cycle_with_voices -> cycle.compute_phase -> theta_C}
voice test.cycle.phase.passed / {theta_C != null -> true}

;; ============================================================================
;; Test 2: Cycle Charge Computation
;; ============================================================================

voice test.cycle.charge / "Test cycle charge computation"
voice test.cycle.charge.input / "cycle_with_charges"
voice test.cycle.charge.expected / "Q_C_product"
voice test.cycle.charge.actual / {cycle_with_charges -> cycle.compute_charge -> Q_C}
voice test.cycle.charge.passed / {Q_C != null -> true}

;; ============================================================================
;; Test 3: Dimensional Promotion
;; ============================================================================

voice test.cycle.promotion / "Test cycle promotes to operator"
voice test.cycle.promotion.input / "resonant_cycle"
voice test.cycle.promotion.expected / "operator_C"
voice test.cycle.promotion.actual / {resonant_cycle -> cycle.promote_to_operator -> operator_C}
voice test.cycle.promotion.passed / {operator_C != null -> true}

;; ============================================================================
;; Test 4: Identity Cycle → Time Operator
;; ============================================================================

voice test.cycle.identity_to_time / "Test identity cycle promotes to time operator"
voice test.cycle.identity_to_time.input / "identity_cycle"
voice test.cycle.identity_to_time.expected / "time_operator_ddt"
voice test.cycle.identity_to_time.actual / {identity_cycle -> cycle.identity_to_time -> time_operator}
voice test.cycle.identity_to_time.passed / {time_operator != null -> true}

;; ============================================================================
;; Test 5: Dialogue Cycle → Rotation Operator
;; ============================================================================

voice test.cycle.dialogue_to_rotation / "Test dialogue cycle promotes to rotation operator"
voice test.cycle.dialogue_to_rotation.input / "dialogue_cycle"
voice test.cycle.dialogue_to_rotation.expected / "rotation_operator_Jz"
voice test.cycle.dialogue_to_rotation.actual / {dialogue_cycle -> cycle.dialogue_to_rotation -> rotation_operator}
voice test.cycle.dialogue_to_rotation.passed / {rotation_operator != null -> true}

;; ============================================================================
;; Test 6: 7-Trace Fundamental Cycle → Complex Unit
;; ============================================================================

voice test.cycle.trace7_fundamental / "Test 7-trace cycle promotes to complex unit"
voice test.cycle.trace7_fundamental.input / "trace7_cycle"
voice test.cycle.trace7_fundamental.expected / "complex_unit_i"
voice test.cycle.trace7_fundamental.actual / {trace7_cycle -> cycle.trace7_fundamental -> complex_unit}
voice test.cycle.trace7_fundamental.passed / {complex_unit != null -> true}

;; ============================================================================
;; Test 7: Learning Threshold
;; ============================================================================

voice test.cycle.learning_threshold / "Test learning threshold triggers promotion"
voice test.cycle.learning_threshold.input / "all_cycles"
voice test.cycle.learning_threshold.expected / "simultaneous_promotion"
voice test.cycle.learning_threshold.actual / {all_cycles -> cycle.learning_threshold -> promotion_result}
voice test.cycle.learning_threshold.passed / {promotion_result != null -> true}

;; ============================================================================
;; Test 8: Promotion Functor
;; ============================================================================

voice test.cycle.promotion_functor / "Test promotion map as functor"
voice test.cycle.promotion_functor.input / "cycle_D"
voice test.cycle.promotion_functor.expected / "operator_D_plus_1"
voice test.cycle.promotion_functor.actual / {cycle_D -> cycle.promotion_functor -> operator}
voice test.cycle.promotion_functor.passed / {operator != null -> true}

;; ============================================================================
;; Test 9: Quantization Rule
;; ============================================================================

voice test.cycle.quantization / "Test resonance as quantization rule"
voice test.cycle.quantization.input / "phase"
voice test.cycle.quantization.expected / "stable_orbit"
voice test.cycle.quantization.actual / {phase -> cycle.quantization_rule -> orbit}
voice test.cycle.quantization.passed / {orbit != null -> true}

;; ============================================================================
;; Test 10: Hermitian Promotion
;; ============================================================================

voice test.cycle.hermitian / "Test dual cycles promote to Hermitian operator"
voice test.cycle.hermitian.input / "cycle + conjugate_cycle"
voice test.cycle.hermitian.expected / "hermitian_operator"
voice test.cycle.hermitian.actual / {cycle + conjugate_cycle -> cycle.hermitian_promotion -> operator}
voice test.cycle.hermitian.passed / {operator != null -> true}

;; ============================================================================
;; Test Suite: Cycle-to-Dimension Principle
;; ============================================================================

voice test.cycle.suite / {
  test.cycle.phase -> 
  test.cycle.charge -> 
  test.cycle.promotion -> 
  test.cycle.identity_to_time -> 
  test.cycle.dialogue_to_rotation -> 
  test.cycle.trace7_fundamental -> 
  test.cycle.learning_threshold -> 
  test.cycle.promotion_functor -> 
  test.cycle.quantization -> 
  test.cycle.hermitian
}

target test_cycle_to_dimension / "cycle_to_dimension_tests"
voice main / {test.cycle.suite -> test_cycle_to_dimension}

