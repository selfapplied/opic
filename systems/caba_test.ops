;;; caba_test.ops — Test CABA v0.1 compression and validation

include systems/caba_validation.ops

;; ============================================================================
;; Test Field Generation
;; ============================================================================

;; Create a test field: simple sine wave
voice create.test.field / {
  field.size "64" -> 
  generate.sine.wave -> 
  test.field
}

;; ============================================================================
;; Mode A Test: Microstate-Lossless
;; ============================================================================

voice test.mode.A / {
  test.field -> 
  caba.pack.mode.A -> 
  caba.unpack.mode.A -> 
  caba.verify.mode.A -> 
  ⟨test_A_result⟩
}

;; ============================================================================
;; Mode B Test: Statistical-Lossless
;; ============================================================================

voice test.mode.B / {
  test.field + random.seed "42" -> 
  caba.pack.mode.B -> 
  caba.unpack.mode.B -> 
  caba.verify.mode.B -> 
  ⟨test_B_result⟩
}

;; ============================================================================
;; Full Validation Suite Test
;; ============================================================================

voice test.full.validation / {
  test.field + compression.mode "A" + random.seed "42" -> 
  caba.validate.full -> 
  ⟨full_validation_result⟩
}

target caba_test / "caba_v0.1_test"
voice main / {
  create.test.field -> 
  test.mode.A + 
  test.mode.B + 
  test.full.validation -> 
  caba_test
}


